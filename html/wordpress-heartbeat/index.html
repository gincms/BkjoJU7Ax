<!DOCTYPE html> <html lang="en"> <head data-gincb="1500940791959"> <meta charset="UTF-8"> <title>Wordpress Heartbeat - Gin (Git-integrated) CMS</title> <link rel="stylesheet" href="/gin-data/themes/gin-whitepaper/css/main.css"> </head> <body> <article> <section class="section"> <div class="container"> <div class="columns"> <div class="column is-8 is-offset-2"> <div class="heading"> <h1 class="title"> <a href="/wordpress-heartbeat/">Wordpress Heartbeat</a> </h1> </div> </div> </div> </div> </section> <section class="section"> <div class="container"> <div class="columns"> <div class="column is-8 is-offset-2"> <div id="primary-content" class="content"> <article> <section class="content-body"> <p>A quick one, but worth covering. If you’ve found this post, you probably already know why the WordPress Heartbeat matters; likely you’ve noticed excessive calls to <code>wp-admin/admin-ajax.php</code>, so I won’t patronise you or waste your time by explaining the basics. If, on the other hand, you <em>don’t</em> know what the WordPress Hearbeat API is, or why it matters, please <a href="https://en-gb.wordpress.org/plugins/heartbeat-control/">read this</a>, but <strong>don’t</strong> install the suggested plugin, at least not before reading and considering what’s below.</p> <h3 id="hearbeat-control">Hearbeat Control</h3> <p>Most posts out there (like the one linked to above) will tell you that, if you want to alter the frequency of the WordPress heartbeat, you should install the <em>Heartbeat Control</em> plugin. This is fine, if you’re a non-technical user. However, if you have some technical knowledge and are comfortable modifying the <code>functions.php</code> file, it makes little sense to add yet another plugin to the stack when you can achieve the desired result by adding 5 lines of code to your <code>functions.php</code>:</p> <pre><code>function limit_heartbeat($settings) {
    $settings[&#39;interval&#39;] = 60; // Frequency of heartbeat in seconds (min: 15, max 120).
    return $settings;
}
add_filter(&#39;heartbeat_settings&#39;, &#39;limit_heartbeat&#39;);
</code></pre><h3 id="limit-heartbeat-on-specific-pages">Limit Heartbeat on specific pages</h3> <p>Altering the <a href="https://github.com/WordPress/WordPress/blob/master/wp-includes/js/heartbeat.js"><code>minimalInterval</code></a> setting as above alters the frequency of autosave when creating and editing posts. If you’d like a different frequency in these instances, you know what to do (add a condition):</p> <pre><code>function limit_heartbeat($settings) {
    global $pagenow;

    // Check which page we&#39;re on, alter the interval if necessary.
    if (in_array($pagenow, array(&#39;new-post.php&#39;,&#39;edit.php&#39;)) {
        $settings[&#39;interval&#39;] = 60; // Frequency of heartbeat in seconds (min: 15, max 120).
    }

    return $settings;
}
add_filter(&#39;heartbeat_settings&#39;, &#39;limit_heartbeat&#39;);
</code></pre><h3 id="completely-disable-the-heartbeat">Completely disable the heartbeat</h3> <p>I wouldn’t recommend doing this, since it will affect WP’s handling of admin sessions, autosave and who knows what else. If you’re desperate to do so though, you just have to deregister the appropriate script:</p> <pre><code>function disable_heartbeat() {
    wp_deregister_script(&#39;heartbeat&#39;, &#39;remove_heartbeat&#39;, 1);
}
add_filter(&#39;init&#39;, &#39;disable_heartbeat&#39;);
</code></pre><h3 id="bonus-limit-all-wp-ajax-requests">Bonus: limit all WP AJAX requests</h3> <p>If you want to reduce the frequency of <em>all</em> WP AJAX requests, just substitute <code>minimalInterval</code> for <code>interval</code>:</p> <pre><code>function limit_heartbeat($settings) {
    $settings[&#39;minimalInterval&#39;] = 60; // Frequency of heartbeat in seconds. (min: 1, max 60)
    return $settings;
}
add_filter(&#39;heartbeat_settings&#39;, &#39;limit_heartbeat&#39;);
</code></pre><p>The comments in the <code>/wp-includes/js/heartbeat.js</code> have this to say about the <code>minimalInterval</code> setting:</p> <blockquote> <p>Used to limit the number of AJAX requests. Overrides all other intervals if they are shorter.</p> </blockquote> <p>I’ve tested it and it does exactly what it says on the tin. If you find that <code>interval</code> doesn’t adequately reduce the calls to <code>wp-admin/admin-ajax.php</code>, try using <code>minimalInterval</code> instead. I recommended exploring <a href="https://github.com/WordPress/WordPress/blob/master/wp-includes/js/heartbeat.js">the file</a> for yourself if you’d like a deeper understanding of how exactly these settings are applied and used.</p> <h3 id="why-not-just-use-the-plugin-">Why not just use the plugin?</h3> <p>When the change you need to make to your WordPress site is beyond your understanding, or the time and energy required to implement the change is beyond what you are willing to sacrifice, use a plugin. If none of the above is true, and the change you want to make is already provided by an existing plugin, but you don’t think you would create a significantly improved solution, use a plugin. Why reinvent the wheel, right?</p> <p>However, if all that’s required to add a specific piece of functionality is essentially a copy and paste of a tiny sample of code into your <code>functions.php</code> (as is the case here), it seems like overkill to reach for a plugin. The WordPress Heartbeat frequency alteration is the type of thing you’ll probably set once and never need to touch again. Why bother with a plugin?</p> <p>Each plugin you add to your WordPress site adds to the overhead. In some cases, that additional overhead is negligible, but often it’s not, and the cumulative effect can on occasion be crippling. Being selective — frugal, even — with the WordPress plugins you choose to use can save you a great deal of <a href="https://www.woothemes.com/2013/09/wordpress-plugins-ignorance/">trouble</a> further down the line.</p> </section> </article> </div> </div> </div> </div> </section> </article> <footer class="footer"> <p class="has-text-centered"> <a href="https://twitter.com/LatnBlack">Twitter</a> </p> <p class="has-text-centered"> <a href="https://latnblack.com">me.com</a> </p> </footer> </body> </html> 